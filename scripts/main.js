"use strict";angular.module("pubTran",["ngAnimate","ngTouch","ui.bootstrap","cb.x2js"]),angular.module("pubTran").constant("bartKey","MW9S-E7SL-26DU-VV8V").constant("idbName","pubTran").constant("idbVersion",1),angular.module("pubTran").factory("Idb",function(t,n){var r={};return r.openConnection=function(){return navigator.serviceWorker?idb.open(t,n,function(t){t.createObjectStore("stations",{keyPath:"abbr"})}):Promise.resolve()},r}),angular.module("pubTran").factory("Sw",function(){function t(){return navigator.serviceWorker?navigator.serviceWorker.register("/Sw.js").then(function(t){return console.log("registered worker with scope: ",t.scope),t})["catch"](function(){console.log("failed to register worker")}):void 0}var n={};return n.worker=t(),n}),angular.module("pubTran").factory("Stations",function(t,n,r,o){var e={},a=o.openConnection();return e.getAll=function(){return t({method:"GET",url:"http://api.bart.gov/api/stn.aspx?cmd=stns&key="+r}).then(function(t){var r=n.xml_str2json(t.data).root.stations.station;return a.then(function(t){if(t){var n=t.transaction("stations","readwrite"),o=n.objectStore("stations");r.forEach(function(t){o.put(t)})}}),r})},e}),angular.module("pubTran").controller("mainController",function(t,n){n.getAll().then(function(n){t.stations=n,t.selectedDeparture=t.stations[0],t.selectedArrival=t.stations[0]})});